<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>
   <extension
         id="com.lambda.plugin.yunit.nature"
         name="Functest Nature"
         point="org.eclipse.core.resources.natures">
      <runtime>
         <run
               class="com.lambda.plugin.YNature">
         </run>
      </runtime>
   </extension>
   <extension
         point="org.eclipse.ui.importWizards">
      <category
            id="com.lambda.plugin.importWizard"
            name="Hybris">
      </category>
   </extension>
   <extension
         id="com.lambda.plugin.views"
         point="org.eclipse.ui.views">
      <category
            id="com.lambda.plugin"
            name="Hybris">
      </category>
      <view
            allowMultiple="false"
            category="com.lambda.plugin"
            class="com.lambda.plugin.yunit.view.YUnitView"
            icon="icons/full/etool16/functest.png"
            id="com.lambda.plugin.yunit.view"
            name="YUnit"
            restorable="true">
      </view>
   </extension>
   <extension
         point="org.eclipse.ui.popupMenus">
      <objectContribution
            adaptable="true"
            id="com.lambda.plugin.project.menu"
            objectClass="org.eclipse.core.resources.IProject">
         <action
               class="com.lambda.plugin.actions.YActionsMenu"
               icon="icons/full/kizoom.png"
               id="com.lambda.plugin.project.menu"
               label="&amp;Hybris"
               menubarPath="additions"
               style="pulldown">
         </action>
         <visibility>
            <and>
               <objectState
                     name="open"
                     value="true">
               </objectState>
               <objectClass
                     name="org.eclipse.core.resources.IProject">
               </objectClass>
            </and>
         </visibility>
      </objectContribution>
   </extension>
   <extension
         point="org.eclipse.ui.newWizards">
      <category
            id="com.lambda.plugin.wizard"
            name="Hybris">
      </category>
      <wizard
            category="com.lambda.plugin.wizard"
            class="com.lambda.plugin.yunit.wizard.NewYUnitProjectWizard"
            hasPages="true"
            icon="icons/full/etool16/newfunctest_wiz.png"
            id="com.lambda.plugin.yunit.wizard.NewFunctestProjectWizard"
            name="Kizoom Functest Project"
            project="true">
         <description>
            Create Kizoom Functest project
         </description>
      </wizard>
   </extension>
   <extension
         point="org.eclipse.ui.perspectiveExtensions">
      <perspectiveExtension
            targetID="org.eclipse.jdt.ui.JavaPerspective">
         <view
               id="com.lambda.plugin.yunit.view"
               ratio="0.5"
               relationship="right"
               relative="org.eclipse.jdt.junit.ResultView">
         </view>
      </perspectiveExtension>
   </extension>
   <extension
         point="org.eclipse.ui.decorators">
      <decorator
            adaptable="true"
            icon="icons/full/dec8/functestprj_dec.png"
            id="com.lambda.plugin.yunit.decorator"
            label="Functest Decorator"
            lightweight="true"
            location="TOP_LEFT"
            state="true">
         <enablement>
            <and>
               <objectClass
                     name="org.eclipse.core.resources.IProject">
               </objectClass>
               <objectState
                     name="nature"
                     value="com.lambda.plugin.yunit.nature">
               </objectState>
            </and>
         </enablement>
      </decorator>
   </extension>
   <extension
         point="org.eclipse.ui.preferencePages">
      <page
            class="com.lambda.plugin.preferences.YPreferencePage"
            id="com.lambda.plugin.preferences.YPreferencePage"
            name="Hybris">
      </page>
      <page
            category="com.lambda.plugin.preferences.YPreferencePage"
            class="com.lambda.plugin.impex.preferences.ImpexPreferencePage"
            id="com.lambda.plugin.impex.preferences.ImpexPreferencePage"
            name="ImpEx">
      </page>
      <page
            category="com.lambda.plugin.preferences.YPreferencePage"
            class="com.lambda.plugin.yunit.preferences.YUnitPreferencePage"
            id="com.lambda.plugin.yunit.preferences.YUnitPreferencePage"
            name="YUnit Tests">
      </page>
   </extension>
   <extension
         id="com.lambda.plugin.preferences"
         name="Hybris Preferences"
         point="org.eclipse.core.runtime.preferences">
      <initializer
            class="com.lambda.plugin.preferences.PreferenceInitializer">
      </initializer>
   </extension>
   <extension
         point="org.eclipse.debug.ui.launchShortcuts">
      <shortcut
            class="com.lambda.plugin.yunit.launcher.YUnitLaunchShortcut"
            icon="icons/full/etool16/run_functest.png"
            id="com.lambda.plugin.yunit.launch.shortcut"
            label="Functional Test"
            modes="run,debug">
         <contextualLaunch>
            <enablement>
               <with
                     variable="selection">
                  <count
                        value="+">
                  </count>
                  <iterate>
                     <adapt
                           type="org.eclipse.jdt.core.IJavaElement">
                        <test property="org.eclipse.jdt.core.isInJavaProject"/>
		                <test property="org.eclipse.jdt.core.hasTypeOnClasspath" value="junit.framework.Test"/>
                  <test
                        forcePluginActivation="true"
                        property="com.lambda.plugin.yunit.canLaunchAsYUnit">
                  </test>
                     </adapt>
                  </iterate>
               </with>
            </enablement>
          </contextualLaunch>
          <configurationType
               id="com.lambda.plugin.yunit.launchconfig">
         </configurationType>
      </shortcut>
   </extension>
      <extension
         point="org.eclipse.debug.core.launchConfigurationTypes">
      <launchConfigurationType
            delegate="com.lambda.plugin.yunit.launcher.YUnitLaunchConfigurationDelegate"
            delegateDescription="Run functional tests "
            delegateName="Functest Launcher"
            id="com.lambda.plugin.yunit.launchconfig"
            modes="run, debug"
            name="Functional Test"
            public="true"
            sourceLocatorId="org.eclipse.jdt.launching.sourceLocator.JavaSourceLookupDirector">
      </launchConfigurationType>
   </extension>
      <extension
            point="org.eclipse.debug.ui.launchConfigurationTabGroups">
         <launchConfigurationTabGroup
               class="com.lambda.plugin.yunit.launcher.YUnitLaunchConfigurationTabGroup"
               id="com.lambda.plugin.yunit.launchgroup"
               type="com.lambda.plugin.yunit.launchconfig">
            <launchMode
                  description="Create a configuration that will launch a Functional Test."
                  mode="run">
            </launchMode>
            <launchMode
                  description="Create a configuration that will launch a Functional Test."
                  mode="debug"
                  perspective="org.eclipse.debug.ui.DebugPerspective">
            </launchMode>
         </launchConfigurationTabGroup>
      </extension>
      <extension
            point="org.eclipse.debug.ui.launchConfigurationTypeImages">
         <launchConfigurationTypeImage
               configTypeID="com.lambda.plugin.yunit.launchconfig"
               icon="icons/full/etool16/run_functest.png"
               id="com.lambda.plugin.yunit.launchconfigimage">
         </launchConfigurationTypeImage>
      </extension>
      <extension
            point="org.eclipse.jdt.launching.classpathProviders">
         <classpathProvider
               class="com.lambda.plugin.yunit.YUnitClasspathProvider"
               id="com.lambda.plugin.yunit.FunctestClasspathProvider">
         </classpathProvider>
      </extension>
      <extension
            point="org.eclipse.core.expressions.propertyTesters">
         <propertyTester
               class="com.lambda.plugin.yunit.YUnitPropertyTester"
               id="com.lambda.plugin.yunit.FunctestLaunchPropertyTester"
               namespace="com.lambda.plugin.functest"
               properties="isFunctest,canLaunchAsFunctest"
               type="org.eclipse.core.runtime.IAdaptable">
         </propertyTester>
      </extension>
      <extension
            point="org.eclipse.ui.bindings">
         <key
               commandId="com.lambda.plugin.yunit.launch.shortcut.run"
               contextId="org.eclipse.ui.contexts.window"
               schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
               sequence="M2+M3+X F">
         </key>
         <key
               contextId="org.eclipse.ui.contexts.window"
               platform="carbon"
               schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
               sequence="M2+M3+X F">
         </key>
         <key
               commandId="com.lambda.plugin.yunit.launch.shortcut.run"
               contextId="org.eclipse.ui.contexts.window"
               platform="carbon"
               schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
               sequence="M1+M3+X F">
         </key>
         <key
               commandId="com.lambda.plugin.yunit.launch.shortcut.debug"
               contextId="org.eclipse.ui.contexts.window"
               schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
               sequence="M2+M3+D F">
         </key>
         <key
               contextId="org.eclipse.ui.contexts.window"
               platform="carbon"
               schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
               sequence="M2+M3+D F">
         </key>
         <key
               commandId="com.lambda.plugin.yunit.launch.shortcut.debug"
               contextId="org.eclipse.ui.contexts.window"
               platform="carbon"
               schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
               sequence="M1+M3+M4+D F">
         </key>
      </extension>
      <extension
            point="org.eclipse.ui.commands">
         <command
               categoryId="org.eclipse.debug.ui.category.run"
               description="Run Functional Test"
               id="com.lambda.plugin.yunit.launch.shortcut.run"
               name="Run Functional Test">
         </command>
         <command
               categoryId="org.eclipse.debug.ui.category.run"
               description="Debug Functional Test"
               id="com.lambda.plugin.yunit.launch.shortcut.debug"
               name="Debug Functional Test">
         </command>
         <command
            name="Rerun Functional Tests"
            description="Rerun Functional Tests"
            categoryId="org.eclipse.debug.ui.category.run"
            id="com.lambda.plugin.yunit.launch.shortcut.rerunLast">
         </command>
         <command
            name="Rerun Functional Tests - Failures Only"
            description="Rerun Functional Tests - Failures Only"
            categoryId="org.eclipse.debug.ui.category.run"
            id="com.lambda.plugin.yunit.launch.shortcut.rerunFailed">
         </command>
         <command
               categoryId="com.lambda.plugin"
               defaultHandler="com.lambda.plugin.yunit.actions.RunFunctestsAction"
               description="Run Staging"
               id="com.lambda.plugin.yunit.RunFunctestStaging"
               name="Run Staging">
         </command>    
         <command
               categoryId="com.lambda.plugin"
               defaultHandler="com.lambda.plugin.yunit.actions.RunFunctestsAction"
               description="Run Production"
               id="com.lambda.plugin.yunit.RunFunctestProduction"
               name="Run Production">
         </command>
         <command
               categoryId="com.lambda.plugin"
               defaultHandler="com.lambda.plugin.yunit.actions.RunFunctestsAction"
               description="Run Local"
               id="com.lambda.plugin.yunit.RunFunctestLocal"
               name="Run Local">
         </command>
         <command
               categoryId="org.eclipse.ui.category.textEditor"
               defaultHandler="com.lambda.plugin.impex.editor.actions.ToggleMarkOccurrences"
               description="Toggle Mark Occurrences"
               id="com.lambda.plugin.impex.editor.actions.ToggleMarkOccurrences"
               name="Toggle Mark Occurrences">
         </command>       
      </extension>
      <extension
            point="org.eclipse.ui.commandImages">
         <image
               commandId="com.lambda.plugin.yunit.RunFunctestProduction"
               disabledIcon="icons/full/dcl16/run_prod.png"
               icon="icons/full/ecl16/run_prod.png">
         </image>
         <image
               commandId="com.lambda.plugin.yunit.RunFunctestStaging"
               disabledIcon="icons/full/dcl16/run_tst.png"
               icon="icons/full/ecl16/run_tst.png">
         </image>
         <image
               commandId="com.lambda.plugin.yunit.RunFunctestLocal"
               disabledIcon="icons/full/dcl16/run_dev.png"
               icon="icons/full/ecl16/run_dev.png">
         </image>
         <image
               commandId="com.lambda.plugin.impex.editor.actions.ToggleMarkOccurrences"
               disabledIcon="icons/full/dcl16/run_dev.png"
               icon="icons/full/ecl16/mark_occurrences.gif">
         </image>
      </extension>
      <extension
            point="org.eclipse.ui.menus">
            
         <menuContribution
               locationURI="toolbar:org.eclipse.ui.main.toolbar">
            <toolbar
                  id="com.lambda.plugin.yunit.toolbar">
               <command
                     commandId="com.lambda.plugin.yunit.RunFunctestLocal"
                     disabledIcon="icons/full/dcl16/run_dev.png"
                     icon="icons/full/ecl16/run_dev.png"
                     label="Run Local"
                     style="push"
                     tooltip="Run workspace functional tests against local server">
               </command>
               <command
                     commandId="com.lambda.plugin.yunit.RunFunctestStaging"
                     disabledIcon="icons/full/dcl16/run_tst.png"
                     icon="icons/full/ecl16/run_tst.png"
                     label="Run Staging"
                     style="push"
                     tooltip="Run workspace functional tests against staging server">
               </command>
               <command
                     commandId="com.lambda.plugin.yunit.RunFunctestProduction"
                     disabledIcon="icons/full/dcl16/run_prod.png"
                     icon="icons/full/ecl16/run_prod.png"
                     label="Run Production"
                     style="push"
                     tooltip="Run workspace functional tests against production server">
               </command>
            </toolbar>
            <toolbar
                  id="com.lambda.plugin.impex.editor.toolbar">
               <command
                     commandId="com.lambda.plugin.impex.editor.actions.ToggleMarkOccurrences"
                     disabledIcon="icons/full/dcl16/mark_occurrences.gif"
                     icon="icons/full/ecl16/mark_occurrences.gif"
                     label="Toggle Mark Occurrences"
                     style="toggle"
                     tooltip="Toggle mark occurrences">
               </command>
               <visibleWhen>
                  <with
                        variable="activeEditorId">
                     <equals
                           value="com.lambda.plugin.impex.editor.ImpexEditor">
                     </equals>
                  </with>
               </visibleWhen>
            </toolbar>
         </menuContribution>
         <menuContribution
            locationURI="menu:org.eclipse.ui.main.menu">
        	<menu
               id="com.lambda.plugin.menu"
               label="Hybris"
               tooltip="Hybris">
         	</menu>
      	 </menuContribution>
         <menuContribution
               locationURI="menu:com.lambda.plugin.menu">
            <separator
                  name="com.lambda.plugin.yunit.menu.separator1"
                  visible="true">
            </separator>
            <command
                  commandId="com.lambda.plugin.yunit.RunFunctestLocal"
                  disabledIcon="icons/full/dcl16/run_dev.png"
                  icon="icons/full/ecl16/run_dev.png"
                  label="Run Local"
                  style="push"
                  tooltip="Run workspace functional tests against local server">
            </command>
            <command
                  commandId="com.lambda.plugin.yunit.RunFunctestStaging"
                  disabledIcon="icons/full/dcl16/run_tst.png"
                  icon="icons/full/ecl16/run_tst.png"
                  label="Run Staging"
                  style="push"
                  tooltip="Run workspace functional tests against staging server">
            </command>
            <command
                  commandId="com.lambda.plugin.yunit.RunFunctestProduction"
                  disabledIcon="icons/full/dcl16/run_prod.png"
                  icon="icons/full/ecl16/run_prod.png"
                  label="Run Production"
                  style="push"
                  tooltip="Run workspace functional tests against production server">
            </command>
         </menuContribution>
      </extension>
      <extension
            point="org.eclipse.ui.handlers">
         <handler
               class="com.lambda.plugin.yunit.actions.RunFunctestsAction"
               commandId="com.lambda.plugin.yunit.RunFunctestLocal">
            <activeWhen>
               <with
                     variable="activeWorkbenchWindow.activePerspective">
                  <or>
                     <equals
                           value="org.eclipse.jdt.ui.JavaPerspective">
                     </equals>
                     <equals
                           value="org.eclipse.debug.ui.DebugPerspective">
                     </equals>
                  </or>
               </with></activeWhen>
         </handler>
         <handler
               class="com.lambda.plugin.yunit.actions.RunFunctestsAction"
               commandId="com.lambda.plugin.yunit.RunFunctestStaging">
            <activeWhen>
               <with
                     variable="activeWorkbenchWindow.activePerspective">
                  <or>
                     <equals
                           value="org.eclipse.jdt.ui.JavaPerspective">
                     </equals>
                     <equals
                           value="org.eclipse.debug.ui.DebugPerspective">
                     </equals></or>
               </with>
            </activeWhen>
         </handler>
         <handler
               class="com.lambda.plugin.yunit.actions.RunFunctestsAction"
               commandId="com.lambda.plugin.yunit.RunFunctestProduction">
            <activeWhen>
               <with
                     variable="activeWorkbenchWindow.activePerspective">
                  <or>
                     <equals
                           value="org.eclipse.jdt.ui.JavaPerspective">
                     </equals>
                     <equals
                           value="org.eclipse.debug.ui.DebugPerspective">
                     </equals>
                  </or>
               </with>
            </activeWhen>
         </handler>
         <handler
               class="com.lambda.plugin.impex.editor.actions.ToggleMarkOccurrencesAction"
               commandId="com.lambda.plugin.impex.editor.actions.ToggleMarkOccurrences">
         </handler>
      </extension>
      <extension
            point="org.eclipse.ui.propertyPages">
         <page
               class="com.lambda.plugin.yunit.properties.YUnitPropertyPage"
               id="com.lambda.plugin.yunit.properties.samplePropertyPage"
               name="Functional Tests"
               nameFilter="*"
               objectClass="org.eclipse.jdt.core.IJavaProject">
            <enabledWhen>
               <and>
                  <test
                        property="projectNature"
                        value="com.lambda.plugin.yunit.nature">
                  </test>
                  <adapt
                        type="org.eclipse.core.resources.IProject">
                  </adapt>
               </and>
            </enabledWhen>
         </page>
      </extension>
      <extension
            point="org.eclipse.ui.editors">
         <editor
               class="com.lambda.plugin.impex.editor.ImpexEditor"
               contributorClass="org.eclipse.ui.texteditor.BasicTextEditorActionContributor"
               extensions="impex"
               icon="icons/sample.gif"
               id="com.lambda.plugin.impex.editor.ImpexEditor"
               name="ImpEx Editor">
         </editor>
      </extension>
      <extension
            id="com.lambda.plugin.impex.ImpexAnnotationModelFactory"
            name="com.lambda.plugin.impex.ImpexAnnotationModelFactory"
            point="org.eclipse.core.filebuffers.annotationModelCreation">
         <factory
               class="com.lambda.plugin.impex.ImpexAnnotationModelFactory"
               extensions="impex">
         </factory>
      </extension>

</plugin>
